---
import NavMobile from "@components/navigation/NavMobile.vue";
import { Icon } from "astro-icon/components";
import ColorSwitch from "@components/common/ColorSwitch.vue";
import { t } from "@util/translate";

const { menu, title, social, color, cta } = Astro.props;
const currentPath = Astro.url.pathname.split("/")[1];

const isActive = (href) => {
  if (currentPath === "" && href == "/") return true;
  if (currentPath !== "" && href.startsWith(`/${currentPath}`)) return true;
};
---

<header id="navbar" class={`nav fixed inset-x-0 top-0 z-50 nav-${color}`}>
  <nav class="inner container-xl flex items-center justify-between gap-6">
    <!-- Logo -->
    <a href="/" aria-label={title} class="flex items-center">
        <img src="/images/logo-img.png" alt="Logo Dominando" class="w-32 h-auto sm:w-16 lg:w-32"  />
    </a>

    <!-- CTA sempre visível -->
    {cta && cta.length > 0 && (
      <div class="flex ml-auto">
        {cta.map((link) => (
          <a
            href={link.href}
            class="btn btn-md btn-ghost btn-gold-shine px-3 py-1 text-sm"
            data-replace={link.label}
          >
            <Icon name="heroicons:shopping-bag" class="h-5 w-5" />
            <span>{link.label}</span>
          </a>
        ))}
      </div>
    )}
  </nav>

  <style>
      /* BOTÃO DOURADO EXTRAVAGANTE (versão navbar) */
      .btn-ghost {
        position: relative;
        overflow: hidden;
        background: linear-gradient(135deg, #FFD700, #FFEA00, #FFC800);
        color: #7A4F00;
        font-weight: 900;
        letter-spacing: 0.5px;
        padding: 0.6rem 1.5rem;
        border-radius: 14px;

        box-shadow:
          0 0 12px rgba(255, 215, 0, 0.8),
          0 0 24px rgba(255, 210, 0, 0.6),
          0 0 34px rgba(255, 200, 0, 0.4);

        border: none !important;

        transition: transform 0.2s ease-out, box-shadow 0.3s ease-out;

        animation: goldPulseNavbar 2.5s infinite ease-in-out;
      }

      /* brilho animado */
      .btn-ghost::before {
        content: "";
        position: absolute;
        top: -120%;
        left: -50%;
        width: 200%;
        height: 350%;
        background: linear-gradient(
          120deg,
          rgba(255, 255, 255, 0) 40%,
          rgba(255, 255, 255, 0.7) 50%,
          rgba(255, 255, 255, 0) 60%
        );
        transform: rotate(25deg);
        animation: shineNavbar 3s infinite linear;
      }

      @keyframes shineNavbar {
        0% { transform: translateX(-150%) rotate(25deg); }
        100% { transform: translateX(150%) rotate(25deg); }
      }

      /* pulsação dourada */
      @keyframes goldPulseNavbar {
        0% {
          box-shadow:
            0 0 12px rgba(255, 215, 0, 0.8),
            0 0 24px rgba(255, 210, 0, 0.6),
            0 0 34px rgba(255, 200, 0, 0.4);
        }
        50% {
          box-shadow:
            0 0 20px rgba(255, 215, 0, 1),
            0 0 40px rgba(255, 210, 0, 0.8),
            0 0 60px rgba(255, 200, 0, 0.6);
        }
        100% {
          box-shadow:
            0 0 12px rgba(255, 215, 0, 0.8),
            0 0 24px rgba(255, 210, 0, 0.6),
            0 0 34px rgba(255, 200, 0, 0.4);
        }
      }

      /* hover */
      .btn-ghost:hover {
        transform: scale(1.07);
        box-shadow:
          0 0 40px rgba(255, 215, 0, 1),
          0 0 70px rgba(255, 210, 0, 0.9),
          0 0 100px rgba(255, 200, 0, 0.7);
        color: #000;
      }

      /* active (click) */
      .btn-ghost:active {
        transform: scale(0.95);
      }


      .btn-gold-shine {
  position: relative;
  overflow: hidden;
}

.btn-gold-shine::after {
  content: "";
  position: absolute;
  top: 0;
  left: -150%;
  width: 50%;
  height: 100%;
  background: linear-gradient(
    120deg,
    rgba(255, 255, 255, 0) 0%,
    rgba(255, 255, 255, 0.6) 50%,
    rgba(255, 255, 255, 0) 100%
  );
  transform: skewX(-20deg);
  animation: shine 2.4s infinite ease-in-out;
}

@keyframes shine {
  0% {
    left: -150%;
  }
  50% {
    left: 150%;
  }
  100% {
    left: 150%;
  }
}
    /* ESTADO NORMAL (TOPO) - TRANSPARENTE, preservando cores do tema */
    .nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;

      /* transparente no topo para não esconder conteúdo atrás */
      background: transparent;
      color: var(--color-text, #111);

      transition: all 0.25s ease;
      transform: none !important;
      opacity: 1 !important;

      height: 6rem;
      display: flex;
      align-items: center;
      backdrop-filter: none !important;
    }

    /* SHRINK - aplica blur + fundo translúcido */
    .nav.shrink {
      height: 4rem;

      /* frame: usa a cor do tema convertida para RGB via variável,
         se não existir, cai para branco semi-trasp */
      background: rgba(var(--color-background-rgb, 255,255,255), 0.85);
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    }

    /* Mantém o conteúdo alinhado */
    .nav .inner {
      height: 100%;
      transition: height 0.25s ease;
    }

    /* segurança: se a logo ou botões forem claros, força contraste no topo */
    .nav:not(.shrink) .btn,
    .nav:not(.shrink) .btn-ghost,
    .nav:not(.shrink) a[aria-label] svg {
      /* não altera suas classes, mas garante visibilidade mínima
         caso o fundo do topo seja claro/escuro: ajuste se precisar */
      filter: none;
      opacity: 1;
    }

    .btn-ghost {
      @apply border-2 border-current;
    }
  </style>
</header>

<!-- SCRIPT DO SHRINK (mesmo, leve e seguro) -->
<script>
  const navbar = document.getElementById("navbar");

  function handleScroll() {
    if (window.scrollY > 20) {
      navbar.classList.add("shrink");
    } else {
      navbar.classList.remove("shrink");
    }
  }

  document.addEventListener("scroll", handleScroll);
</script>
