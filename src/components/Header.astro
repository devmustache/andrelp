---
import NavMobile from "@components/navigation/NavMobile.vue";
import { Icon } from "astro-icon/components";
import ColorSwitch from "@components/common/ColorSwitch.vue";
import { t } from "@util/translate";

const { menu, title, social, color, cta } = Astro.props;
const currentPath = Astro.url.pathname.split("/")[1];

const isActive = (href) => {
  if (currentPath === "" && href == "/") return true;
  if (currentPath !== "" && href.startsWith(`/${currentPath}`)) return true;
};
---

<header id="navbar" class={`nav fixed inset-x-0 top-0 z-50 nav-${color}`}>
  <nav class="inner container-xl flex items-center justify-between gap-6">
    <!-- Logo -->
    <a href="/" aria-label={title} class="flex items-center">
      <Icon name="logo" class="h-6" />
    </a>

    <!-- CTA sempre visível -->
    {cta && cta.length > 0 && (
      <div class="flex ml-auto">
        {cta.map((link) => (
          <a
            href={link.href}
            class="btn btn-md btn-ghost px-3 py-1 text-sm"
            data-replace={link.label}
          >
            <Icon name="heroicons:shopping-bag" class="h-5 w-5" />
            <span>{link.label}</span>
          </a>
        ))}
      </div>
    )}
  </nav>

  <style>
    /* ESTILO DO BOTÃO “COMPRAR AGORA” */
    .btn-ghost {
      background-color: #FFD700; /* verde vívido */
      color: #000;               /* texto preto */
      border: 2px solid #fff;    /* borda branca */
      font-weight: 600;
    }

    /* Hover */
    .btn-ghost:hover {
      background-color: #D3AF37; /* verde um pouco mais escuro no hover */
      color: #fff;
      border-color: #fff;
    }
    /* ESTADO NORMAL (TOPO) - TRANSPARENTE, preservando cores do tema */
    .nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;

      /* transparente no topo para não esconder conteúdo atrás */
      background: transparent;
      color: var(--color-text, #111);

      transition: all 0.25s ease;
      transform: none !important;
      opacity: 1 !important;

      height: 6rem;
      display: flex;
      align-items: center;
      backdrop-filter: none !important;
    }

    /* SHRINK - aplica blur + fundo translúcido */
    .nav.shrink {
      height: 4rem;

      /* frame: usa a cor do tema convertida para RGB via variável,
         se não existir, cai para branco semi-trasp */
      background: rgba(var(--color-background-rgb, 255,255,255), 0.85);
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    }

    /* Mantém o conteúdo alinhado */
    .nav .inner {
      height: 100%;
      transition: height 0.25s ease;
    }

    /* segurança: se a logo ou botões forem claros, força contraste no topo */
    .nav:not(.shrink) .btn,
    .nav:not(.shrink) .btn-ghost,
    .nav:not(.shrink) a[aria-label] svg {
      /* não altera suas classes, mas garante visibilidade mínima
         caso o fundo do topo seja claro/escuro: ajuste se precisar */
      filter: none;
      opacity: 1;
    }

    .btn-ghost {
      @apply border-2 border-current;
    }
  </style>
</header>

<!-- SCRIPT DO SHRINK (mesmo, leve e seguro) -->
<script>
  const navbar = document.getElementById("navbar");

  function handleScroll() {
    if (window.scrollY > 20) {
      navbar.classList.add("shrink");
    } else {
      navbar.classList.remove("shrink");
    }
  }

  document.addEventListener("scroll", handleScroll);
</script>
